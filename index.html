<!doctype html>
<html>
<head>
	<meta name="generator" content="Hugo 0.25.1" />
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Viemacs Notes</title>
    <link href='/slate/stylesheets/monokai.css' rel="stylesheet" media="screen" />
<link href='/slate/stylesheets/screen.css' rel="stylesheet" media="screen" />
<link href='/slate/stylesheets/print.css' rel="stylesheet" media="print" />

    
<script src='/slate/javascripts/all.js'></script>

    
</head>
<body class="index" data-languages="[ &#34;go&#34; ,  &#34;c&#43;&#43;&#34; ,  &#34;shell&#34; ,  &#34;python&#34; ,  &#34;javascript&#34; ]">
    <a href="#" id="nav-button">
        <span>
        NAV
        <img src='/slate/images/navbar.png'/>
      </span>
    </a>
    <div class="tocify-wrapper">
        
         <img src='/images/logo.png' />
        
        <div class="lang-selector">
            
            <a href="#" data-language-name="go">Go</a>
            
            <a href="#" data-language-name="c&#43;&#43;">C&#43;&#43;</a>
            
            <a href="#" data-language-name="shell">Shell</a>
            
            <a href="#" data-language-name="python">Python</a>
            
            <a href="#" data-language-name="javascript">Javascript</a>
            
        </div>
         
        
        <div class="search">
            <input type="text" class="search" id="input-search" placeholder='Search'>
        </div>
        <ul class="search-results"></ul>
        
        <div id="toc">
        </div>
         
        
        

    </div>
    <div class="page-wrapper">
        <div class="dark-box"></div>
        <div class="content">
            
    
        

<h1 id="introduction">Introduction</h1>

<p>Welcome to the Kittn API! You can use our API to access Kittn API endpoints, which can get information on various cats, kittens, and breeds in our database.</p>

<p>We have language bindings in Shell, Ruby, and Python! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<p><strong>This example API documentation page was created with <a href="https://github.com/bep/docuapi/">DocuAPI</a>, a multilingual documentation theme for the static site generator <a href="http://gohugo.io/">Hugo</a>.</strong></p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;github.com/bep/kittn/auth&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">api</span> <span class="o">:=</span> <span class="nx">auth</span><span class="p">.</span><span class="nx">Authorize</span><span class="p">(</span><span class="s">&quot;meowmeowmeow&quot;</span><span class="p">)</span>

	<span class="c1">// Just to make it compile</span>
	<span class="nx">_</span> <span class="p">=</span> <span class="nx">api</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="nb">require</span> <span class="s1">&#39;kittn&#39;</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">authorize!</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span><span class="c1"># With shell, you can just pass the correct header with each request</span>
curl <span class="s2">&quot;api_endpoint_here&quot;</span>
  -H <span class="s2">&quot;Authorization: meowmeowmeow&quot;</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;kittn&#39;</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">);</span>
</code></pre></div>

<blockquote>
<p>Make sure to replace <code>meowmeowmeow</code> with your API key.</p>
</blockquote>

<p>Kittn uses API keys to allow access to the API. You can register a new Kittn API key at our <a href="http://example.com/developers">developer portal</a>.</p>

<p>Kittn expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code>Authorization: meowmeowmeow</code></p>

<aside class="notice">
You must replace <code>meowmeowmeow</code> with your personal API key.
</aside>

<h1 id="etwas">Etwas</h1>

<h2 id="just-some-new-subjects">Just some new subjects</h2>

<h3 id="more-hierarchy-layers">more hierarchy layers</h3>

<h4 id="head-4">head 4</h4>

<h1 id="kittens">Kittens</h1>

<h2 id="get-all-kittens">Get All Kittens</h2>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;github.com/bep/kittn/auth&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">api</span> <span class="o">:=</span> <span class="nx">auth</span><span class="p">.</span><span class="nx">Authorize</span><span class="p">(</span><span class="s">&quot;meowmeowmeow&quot;</span><span class="p">)</span>

	<span class="nx">_</span> <span class="p">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">GetKittens</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="nb">require</span> <span class="s1">&#39;kittn&#39;</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">authorize!</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>curl <span class="s2">&quot;http://example.com/api/kittens&quot;</span>
  -H <span class="s2">&quot;Authorization: meowmeowmeow&quot;</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;kittn&#39;</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">kittens</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>
</code></pre></div>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Fluffums&quot;</span><span class="p">,</span>
    <span class="nt">&quot;breed&quot;</span><span class="p">:</span> <span class="s2">&quot;calico&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fluffiness&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="nt">&quot;cuteness&quot;</span><span class="p">:</span> <span class="mi">7</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
    <span class="nt">&quot;breed&quot;</span><span class="p">:</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
    <span class="nt">&quot;fluffiness&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="nt">&quot;cuteness&quot;</span><span class="p">:</span> <span class="mi">10</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<p>This endpoint retrieves all kittens.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code>GET http://example.com/api/kittens</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>include_cats</td>
<td>false</td>
<td>If set to true, the result will also include cats.</td>
</tr>

<tr>
<td>available</td>
<td>true</td>
<td>If set to false, the result will include kittens that have already been adopted.</td>
</tr>
</tbody>
</table>

<aside class="success">
Remember — a happy kitten is an authenticated kitten!
</aside>

<h2 id="get-a-specific-kitten">Get a Specific Kitten</h2>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;github.com/bep/kittn/auth&quot;</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">api</span> <span class="o">:=</span> <span class="nx">auth</span><span class="p">.</span><span class="nx">Authorize</span><span class="p">(</span><span class="s">&quot;meowmeowmeow&quot;</span><span class="p">)</span>

	<span class="nx">_</span> <span class="p">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">GetKitten</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="nb">require</span> <span class="s1">&#39;kittn&#39;</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">authorize!</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>curl <span class="s2">&quot;http://example.com/api/kittens/2&quot;</span>
  -H <span class="s2">&quot;Authorization: meowmeowmeow&quot;</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;kittn&#39;</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">&#39;meowmeowmeow&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre></div>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span></span><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
  <span class="nt">&quot;breed&quot;</span><span class="p">:</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
  <span class="nt">&quot;fluffiness&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="nt">&quot;cuteness&quot;</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>
</code></pre></div>

<p>This endpoint retrieves a specific kitten.</p>

<aside class="warning">Inside HTML code blocks like this one, you can't use Markdown, so use <code>&lt;code&gt;</code> blocks to denote code.</aside>

<h3 id="http-request-1">HTTP Request</h3>

<p><code>GET http://example.com/kittens/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>ID</td>
<td>The ID of the kitten to retrieve</td>
</tr>
</tbody>
</table>

    
        

<h1 id="algorithm">Algorithm</h1>

    
        

<h2 id="huffman-encoding">Huffman Encoding</h2>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">left</span> <span class="ow">and</span> <span class="n">right</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">weight</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">weight</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="s1">&#39;1&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">r</span>


<span class="k">def</span> <span class="nf">genHuffman</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>
    <span class="n">nodeList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">char</span><span class="p">)):</span>
        <span class="n">nodeList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">char</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodeList</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">nodeList</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">nodeList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">nodeList</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">right</span> <span class="o">=</span> <span class="n">nodeList</span><span class="o">.</span><span class="n">pop</span><span class="p">()))</span>

    <span class="k">return</span> <span class="n">nodeList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">nodeList</span> <span class="k">else</span> <span class="n">Node</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">getFrequency</span><span class="p">(</span><span class="n">freq</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">/</span><span class="n">total</span><span class="p">,</span> <span class="n">freq</span><span class="p">))</span>

<span class="c1"># test</span>
<span class="n">symbol</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">genHuffman</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>

<span class="c1"># output</span>
<span class="c1"># space	7	111</span>
<span class="c1"># a	4	010</span>
<span class="c1"># e	4	000</span>
<span class="c1"># f	3	1101</span>
<span class="c1"># h	2	1010</span>
<span class="c1"># i	2	1000</span>
<span class="c1"># m	2	0111</span>
<span class="c1"># n	2	0010</span>
<span class="c1"># s	2	1011</span>
<span class="c1"># t	2	0110</span>
<span class="c1"># l	1	11001</span>
<span class="c1"># o	1	00110</span>
<span class="c1"># p	1	10011</span>
<span class="c1"># r	1	11000</span>
<span class="c1"># u	1	00111</span>
<span class="c1"># x	1	10010</span>

<span class="n">symbol</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;space&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">genHuffman</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div>

<p>Huffman encoding goes from leaves to root, unlike Shanno-Fano encoding which goes from root to leaves.</p>

<p>A simple alg using a priority queue.</p>

<ol>
<li>Create a leaf-node for each symbol, with the info of the symbol&rsquo;s frequency.</li>
<li>Loop while there are more than 1 node in the queue

<ul>
<li>Replace the 2 nodes of lowest probability, with 1 node that takes the 2 nodes as children and its weight is the sum of the 2 nodes&rsquo; weight.</li>
</ul></li>
<li>The last one node is the root of the completed tree.</li>
</ol>

    
        

<h1 id="editor">Editor</h1>

<h2 id="emacs">Emacs</h2>

<h3 id="emacs-config-file">Emacs Config File</h3>

<p><a href="./editor/init.el">init.el</a></p>

    
        

<h2 id="vim-shortcuts">VIM Shortcuts</h2>

<h3 id="退出">退出</h3>

<ul>
<li>w filename: 保存正在编辑的文件filename</li>
<li>wq filename: 保存后退出正在编辑的文件filename</li>
<li>q：退出不保存。</li>
</ul>

<h3 id="窗口操作">窗口操作</h3>

<ul>
<li>ctrl+w p: 在两个分割窗口之间来回切换。</li>
<li>ctrl+w j: 跳到下面的分割窗</li>
<li>ctrl+w h: 跳到左边的分割窗。</li>
<li>ctrl+w k: 跳到上面的分割窗。</li>
<li>ctrl+w l: 跳到右边的分割窗。</li>
</ul>

<h3 id="移动">移动</h3>

<pre><code>h,j,k,l: 左，下，上，右。
w: 下一个词的词首。
e:下一个词的词尾。
b:上一个词的词首。
&lt;&gt;: v 模式选中后进行缩进。
</code></pre>

<h3 id="跳转">跳转</h3>

<pre><code>%: 可以匹配{},&quot;&quot;,(),[]之间跳转。
H、M、L：直接跳转到当前屏幕的顶部、中部、底部。
#H：跳转到当前屏的第#行。
#L：跳转到当前屏的倒数第#行。
zt: 当前编辑行置为屏顶。
zz: 当前编辑行置为屏中。
zb: 当前编辑行置为屏底。
G：直接跳转到文件的底部。
gg: 跳转到文件首。
():跳转到当前的行首、行尾。
{}：向上、向下跳转到最近的空行。
[{：跳转到目前区块开头。
]}：跳转到目前区块结尾。
0: 跳转到行首。
$: 跳转到行尾。
2$: 跳转到下一行的行尾。
#：跳转到该行的第#个位置。
#G: 15G,跳转到15行。
:#：跳转到#行。
f'n'：跳转到下一个&quot;n&quot;字母后。
ctrl+b: 向后翻一页。
ctrl+f：向前翻一页。
ctrl+u: 向后翻半页。
ctrl+d: 向前翻半页。
ctry+e: 下滚一行。
</code></pre>

<h3 id="选择">选择</h3>

<pre><code>1.V: 选择一行。
2.^V: 矩形选择。
3.v3w: 选择三个字符。  
</code></pre>

<h3 id="编辑">编辑</h3>

<pre><code>1. 新增：
    i: 光标前插入。
    I: 在当前行首插入。
    a: 光标后插入。
    A: 当前行尾插入。
    O: 在当前行之前插入新行。
    o: 在当前行之后插入新行。
2. 修改 c(change) 为主：
    r: 替换光标所在处的字符。
    R：替换光标所到之处的字符。
    cw: 更改光标所在处的字到字尾处。
    c#w: c3w 修改3个字符。
    C：修改到行尾。
    ci'：修改配对标点符号中的文本内容。
    di'：删除配对标点符号中的文本内容。
    yi'：复制配对标点符号中的文本内容。
    vi'：选中配对标点符号中的文本内容。
    s：替换当前一个光标所处字符。
    #S：删除 # 行，并以新文本代替。
3. 删除 d(delete) 为主：
    D：删除到行尾。
    X: 每按一次，删除光标所在位置的前面一个字符。
    x: 每按一次，删除光标所在位置的后面一个字符。
    #x: 删除光标所在位置后面6个字符。
    d^: 删至行首。
    d$: 删至行尾。
    dd:(剪切)删除光标所在行。        
    dw: 删除一个单词/光标之后的单词剩余部分。
    d4w: 删除4个word。
    #dd: 从光标所在行开始删除#行。
    daB: 删除{}及其内的内容。
    diB: 删除{}中的内容。
    n1,n2 d：将n1,n2行之间的内容删除。
4. 查找：
    /： 输入关键字，发现不是要找的，直接在按n，向后查找直到找到为止。
    ?： 输入关键字，发现不是要找的，直接在按n，向前查找直到找到为止。
    *: 在当前页向后查找同一字。
    #: 在当前页向前查找同一字。
5. 复制 y(yank)为主：
    yw: 将光标所在之处到字尾的字符复制到缓冲区中。
    #yw: 复制#个字到缓冲区。
    Y：相当于yy, 复制整行。
    #yy:表示复制从光标所在的该行往下数#行文字。
    p: 粘贴。所有与y相关的操作必用p来结合粘贴。
    n1,n2 co n3：复制第n1行到第n2行之间的内容到第n3行后面。
6. 大小写转换：
    gUU: 将当前行的字母改为大写。
    guu: 将当前行的字母改为小写。
    gUw: 将当前光标下的单词改为大写。
    guw: 将当前光标下的单词改为小写。
    a. 整篇大写:
    ggguG
    gg: 光标到文件第一个字符。
    gu: 把选择范围全部小写。
    G: 到文件结束。
    b. 整篇小写：gggUG
7.  其它：
    J：当前行和下一行合并成一行。
8.  移动：
    n1,n2 m n3：将n1行到n2行之间的内容移至n3行下。
</code></pre>

    
        

<h1 id="errors">Errors</h1>

<aside class="notice">This error section is stored in a separate file, errors.md. DocuAPI allows you to split the single page documentation in as many files as needed. Files are included in the  default Hugo page order . One way of ordering the pages is by setting the page `weight` in the front matter. Pages with lower weight will be listed first.</aside>

<p>The Kittn API uses the following error codes:</p>

<table>
<thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead>

<tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>

<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>

<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>

<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>

<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>

<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>

<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>

<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>

<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slow down!</td>
</tr>

<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>

<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody>
</table>

    
        

<h1 id="javascript">Javascript</h1>

<h2 id="thoughts">Thoughts</h2>

<h3 id="why-javascript">Why JavaScript</h3>

<p>I use JavaScript to develop products because it seems faster and easier.
Use web browsers as JVM, use DOM to build UI, and sue JS to implement business logic.</p>

<h3 id="react">React</h3>

<p>React provides a different way of organize frontend codes. And I like it very much.</p>

<p>Before writing WebApp, my programming practice uses Cpp mostly.
So class and components are very handy, and very easy to understand.
Different from the noodle of Vanilla JS in complex application,
React divides the system to proper components, and makes the data flow in one direction only.</p>

<p>Since more services are moved to Cloud, there are more business-oriented applications
which are more complex than client/consumer oriented apps.
React can make some real differences in these fields.</p>

<h3 id="vanilla-js">Vanilla JS</h3>

<p>Some time it seems Vanilla JS is not important, bacause lib like jQuery wrapped up many things.
During the early stage of developing an app, you might need to find certain libs to solve the problems you are facing.
When you put those codes together, you might encounter problems, and to handle those problems, Vanilla JS is very helpful in locating the problem and finger out what&rsquo;s wrong.</p>

<p>Another thing is if you need to glue some modules together, sometimes you need to use Vanilla JS to do the job, instead of find another lib to glue modules.</p>

<h3 id="react-createclass-vs-component">React createClass vs Component</h3>

<p>ES6 class might be just a syntactic sugar instead of real class, but things are headed towards this way.
I choose to write my code the ES6 way when it&rsquo;s convenient.
As to Component, it&rsquo;s neater than createClass.
No trailing comma, less extra parentheses, and easier to read.</p>

<p><a href="https://reactjsnews.com/composing-components" title="React.Component vs React.createClass">Ref</a></p>

<h2 id="number">Number</h2>

<h3 id="integer">Integer</h3>

<blockquote>
<p>环境 64位 Linux, nodejs v7.2.1</p>
</blockquote>

<ul>
<li>16位数 可以正确显示</li>
<li>17位数 17位上开始失准; 然后归双; 然后舍入, 17位为0</li>
<li>18-22位数 16位后直接丢失, 变为0</li>
<li>23位以上, 变为浮点数, 进行 parseInt() 会出错</li>
</ul>

<h2 id="delete-operator-in-js"><em>delete</em> operator in JS</h2>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete#section_5">Ref</a></p>

<p>The <strong>delete</strong> operator removes a property from an object.</p>

<pre><code>delete expression
</code></pre>

<p>where <code>expression</code> should evaluate to a property reference.</p>

<pre><code>delete object.property
delete object['property']
</code></pre>

<p>Parameters</p>

<p><strong>object</strong> The name of an object, or an expression evaluating to an object.</p>

<p><strong>property</strong> The property to delete.</p>

<p>N.B., the <strong>delete</strong> operator has <strong>nothing</strong> to do with directly freeing memory.
Memory management is done indirectly via breaking references.</p>

<ul>
<li><em>delete</em> will return <em>true</em> on successful deletion, or it will <em>false</em> or raises a SyntaxError or ReferenceError in strict mode.</li>
<li>Notice that <em>delete</em> will also return <em>true</em> if the target property does not exist and <em>delete</em> has no effect.</li>
<li>Delete can only remove own properties. If the prototype chain has a property with the same name, then the object will use it.</li>
<li>An property declared with <em>var</em> cannot be deleted from global/function scope.</li>
<li><em>function</em> can only be deleted if it&rsquo;s a part of an object.</li>
<li>An property declared with <em>let</em> or <em>const</em> cannot be deleted from their scope.</li>
<li>Non-configurable properties cannot be <em>deleted</em>, which includes properties of built-in objects like <em>Math</em>, <em>Array</em>, <em>Object</em>, and properties created by Objects.defineProperty().</li>
</ul>

<h2 id="array">Array</h2>

<h3 id="array-loop">Array Loop</h3>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="k">of</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">;</span>

<span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>

<span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="nx">e</span><span class="p">});</span>

<span class="nx">arr</span><span class="p">.</span><span class="nx">every</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="nx">e</span><span class="p">});</span>

<span class="nx">arr</span><span class="p">.</span><span class="nx">some</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="nx">e</span><span class="p">});</span>
</code></pre></div>

    
        

<h2 id="js-development-environment">JS Development Environment</h2>

<p>随着前端和 Node.JS 的发展, 以及页面的APP化, JS 成为开发应用的不错的选择.
前后通吃, 语法灵活, 发展迅速, 对提高开发效率很有帮助.</p>

<p>JS 开发发展迅速带来的一个问题是工具和库众多, 开发中选择什么工具成了一个问题.
我从两年前真正开始写JS开始尝试了一些工具和库, 试过之后才知道什么更适合自己.</p>

<h3 id="编辑器">编辑器</h3>

<p>单就文本编辑器而言, 当然还是首推 Emacs 和 Vim. 除这两者之外, 还有许多不错和编辑器和IDE.</p>

<ul>
<li>Sublime 比较灵活, 有插件, 可配置. 上手容易, 但要用上各种插件有点繁.</li>
<li>Atom 比较适合前端技术栈, github 出品, 应该不错. 没真正用过.</li>
<li>Brackets 使用时感觉很方便, web 预览功能很不错. 当时版本较早, 有一些bug, 现在应该更好用了.</li>
<li>WebStorm 完整的 IDE 的样子, 对 JS 开发非常不错, 前端, Node.JS, git 都支持, 也有 emacs 模式. 用习惯之后对生产效率应该会有提升.</li>
</ul>

<h3 id="打包">打包</h3>

<p>打包包括了开发上线所需的预编译, 压缩, 转换, 优化, 构建任务.</p>

<p>现在使用的是 Webpack. 既然 Webpack 有丰富的loader, 方便的 API, 良好的生态环境, 为什么不用它呢?</p>

<p>由于接触JS工程比较晚, 有 Webpack 可用, 对早期的 Grunt 和后来的 Gulp 并不了解.
大家似乎是觉得 Grunt 配置麻烦, 效率不高, 于是转向 Gulp.
还有就是使用 NPM 的构建方式, 我不怎么会用, 感觉和上面三种打包工具不属一类工具.
在自己的工程中尝试使用过 Grunt 和 Gulp, 由于工程较小, 使用起来并没有感觉方便.
在压缩js, 分发文件方面, 比自己写 Python 脚本更复杂.</p>

<p>Grunt 要完成配置之后, 在日常开发中, 通过一个命令就能自动完成文件合并压缩, 上线构建, 在线重载(live-reload).
在项目变得复杂之后, 仅靠配置难以满足需求, 只有增加插件配置项. 而越来越多的配置项使得Grunt的配置变得过于麻烦.</p>

<p>Gulp 则是提供类 Linux 的文件流操作, 以编程的方式组建任务, 来解决越来越多的配置项的问题.</p>

<hr />

<h3 id="webpack-vue-心得">webpack + vue 心得</h3>

<p>(ref: wechat 医小生与程序猿 (doctor_programmer))</p>

<ol>
<li><p><strong>要单页面还是多页面</strong>。我们的项目比较大，目录又多又深，如果用配合vue-router做成整体的单页面应用，必然会因多级嵌套路由而造成各种困扰。所以最终决定一个功能模块一个页面，各模块自己做成SPA。这个方案也为后面进行多入口打包带来了麻烦。</p></li>

<li><p><strong>公共框架如何处理。</strong>  所谓公共框架就是像vue、jquery、bootstrap这的第三方框架。 它们基本不会改动，所以肯定是要单独打成一个包的，充分利用缓存。另外一个问题就是，这些框架的代码放哪里好，有人用bower管理，有人用npm管理，或者是像我们之前那样在项目中放一个lib目录，下载好框架代码后就放进去不动了。不过现在业界普遍都推commonjs规范了，所以用npm来管理是个趋势。</p></li>

<li><p><strong>项目的公用组件如何打包。</strong>  既然是用vue，那肯定会写很多公共的组件了，这些组件肯定不能和第三方库打包到一起，也不要和业务代码打包在一起，因为业务代码总改动，而公共组件相对改动也比较少。最好是把所有的组件打成一个包。然而webpack的设计思想并不是这样，它是完全按照模块的依赖树来分析，根据依赖进行打包。我们的组件之间如果没有依赖，是没法打到一起的。</p></li>

<li><p><strong>CommonsChunkPlugin的硬伤。</strong>  关于公用组件的处理，其实可以用CommonsChunkPlugin这个插件，它能自动分析出公共模块并打成一个包。但是这个插件有个硬伤，如果我写了一个名为popbox的组件，本意是想给项目公用，但是目前只有一个模块用到了它，那么插件并不能知道它是公用插件，而会把它和业务代码打包到一起。倘若将来有第二个模块用到了popbox，就又会把它打进公共包里，这显然是很弱智的行为。</p></li>

<li><p><strong>entry只干入口的事。</strong>  我一开始想，把公共组件放entry中打包一下行不行，像这样配置：<code>components: ['loading', 'menu', 'box']</code>。结果证明是不能的，文件虽然能打包出来，但是没法用，就是你<code>&lt;script&gt;</code>标签把文件加到页面也不行，别的模块用require无法引用到。原因就是entry打包出的文件作为入口文件，必须包含直接运行的代码。</p></li>

<li><p><strong>webpack-stream是个鸡肋。</strong>  一开始我被entry和output的各种配置整的摸不着头脑，因为项目目录多，想要更精细的控制，却发现output总是无法按我的需求输出。后来我看到了有webpack-stream这个东西，而且是官方推荐的。简单来讲，它就是实现了文件流接口，从而能与gulp配合工作，我一看这是个好东西啊。研究了一番，发现也没什么功能，就是能用gulp.src代替entry，用gulp.dest代替output，对于多入口打包，就完全没什么用了，还得在webpack中配置，所以简直就是个鸡肋。直接弃用。</p></li>

<li><p><strong>这么多require用哪个。</strong>  一开始用webpack构建应用的时候，每当写require的时候我是懵逼的，有commonjs风格的require用法、AMD风格的require加回调用法，以及webpack提供的require.ensure用来打包异步加载的模块。另外还有ES6的import，既然都用vue了，我们肯定得用ES6嘛。这么多引入模块的方法，你得保持头脑清醒了，他们都有什么区别，什么场景下用哪个。</p></li>

<li><p><strong>dist目录不是给人看的。</strong>  鉴于之前用gulp的习惯，打包后的目录也是有很清晰的结构，而且打包前我们src目录下的代码也是直接可运行的。但是有了webpack之后，首先src下的代码未经打包不能在开发环境运行，其次output选项只能指定一个输出目录，无法再按你的想法再进行组织。唯一有点用的方法是在entry中，把入口文件名字写成这样foo/bar/baz。勉强能在输出目录中新建出文件夹。但是总体来看，dist目录还是一团糟，尤其是异步的chunk文件，只能是id+hash这样的名字。所以我也明白了，要用webpack就别打算去看dist目录了，只能用sourcemap在浏览器看。</p></li>
</ol>

    
        

<h2 id="core-features-of-es2015-es6">Core Features of ES2015 (ES6)</h2>

<p><span style="color:#999">Note on Adrain Mejia&rsquo;s article</span></p>

<h3 id="history">History</h3>

<p>ES6, a.k.a. ES2015+, ECMAScript6.</p>

<p>Javascript is evolving since it was created, and ES6 is now well supported in all modern browsers.</p>

<p><img src="http://www.itnose.net/img/20161122/196231.png" alt="" />
<img src="http://www.itnose.net/img/20161122/196240.png" alt="" />
(<a href="https://kangax.github.io/compat-table/es6/">compatibility ref</a>)</p>

<h3 id="es6-core-features">ES6 core features</h3>

<h4 id="block-scoped-variables">block-scoped variables</h4>

<p>We know that <em>var</em> is not block-scoped, but function scoped.
In ES6, <em>let</em> and <em>const</em> is used instead of <em>var</em> to limit variable scoped to block.
<strong><em>let</em> is the better <em>var</em></strong>
A variable must be defined before use when it&rsquo;s defined by <em>let</em>, and it exists only inside its block, like a for-loop or if-block.</p>

<h4 id="hoist">Hoist</h4>

<pre><code>var x = 'outer';
function test(inner) {
  if (inner) {
    var x = 'inner';
    return x;
  }
  return x;
}
test(false);
// &lt;- undefined
</code></pre>

<p>Using <em>var</em>, even the <code>if</code> clause was not executed, the <code>x</code> inside it was hoisted. But only the declaration was hoisted, not the initialization.</p>

<h4 id="temporal-dead-zone">Temporal Dead-zone</h4>

<p>In ES6, <em>let</em> hoists a variable to the top of the block, and from the top on the block to the <em>let</em> declaration is a &ldquo;temporal dead zone&rdquo;, where a variable is not usable (ReferenceError).</p>

<h4 id="no-more-iife">No more IIFE</h4>

<p>We all familiar with IIFE (Immediately-Invoked Function Expression), and write it everyday. Because without IIFE, the function names and variables will pollute everywhere.</p>

<pre><code>(function() {
  var bar = 'ES5';
  function foo() {}
}());
</code></pre>

<p>With <em>let</em> grammar, IIFE is not essential anymore.</p>

<pre><code>{
  let bar = 'ES6';
  let foo = () =&gt; {};
}
</code></pre>

<h4 id="const">const</h4>

<p>When a re-assignation is necessary, ust <em>let</em>.
When the value of a variable should not be changable, use <em>const</em>.</p>

<pre><code>const _version = '0.1';
</code></pre>

<h4 id="text-template">Text Template</h4>

<pre><code>// ES5
var firstName = 'Adrian';
var lastName = 'Mejia';
console.log('Your name is ' + firstName + ' ' + lastName + '.');
</code></pre>

<p>Now <em>`</em> and <em>${}</em> is available.</p>

<pre><code>// ES6
const firstName = 'Adrian';
const lastName = 'Mejia';
console.log(`Your name is ${firstName} ${lastName}`);
</code></pre>

<h4 id="multi-line-string">Multi-line String</h4>

<pre><code>// ES5
var template = '&lt;li *ngFor=&quot;let todo of todos&quot; [ngClass]=&quot;{completed: todo.isDone}&quot; &gt;n' +
'  &lt;div class=&quot;view&quot;&gt;n' +
'    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; [checked]=&quot;todo.isDone&quot;&gt;n' +
'    &lt;label&gt;&lt;/label&gt;n' +
'    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;n' +
'  &lt;/div&gt;n' +
'  &lt;input class=&quot;edit&quot; value=&quot;&quot;&gt;n' +
'&lt;/li&gt;';
console.log(template);
</code></pre>

<p>Just using <em>`</em>, you can write multiple string directly.</p>

<pre><code>// ES6
const template = `&lt;li *ngFor=&quot;let todo of todos&quot; [ngClass]=&quot;{completed: todo.isDone}&quot; &gt;
  &lt;div class=&quot;view&quot;&gt;
    &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; [checked]=&quot;todo.isDone&quot;&gt;
    &lt;label&gt;&lt;/label&gt;
    &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;
  &lt;/div&gt;
  &lt;input class=&quot;edit&quot; value=&quot;&quot;&gt;
&lt;/li&gt;`;
console.log(template);
</code></pre>

<h4 id="deconstruction-and-assignment">Deconstruction and Assignment</h4>

<p>Get array elements.</p>

<pre><code>// ES5
var array = [1, 2, 3, 4];
var first = array[0];
var third = array[2];
console.log(first, third); // 1 3
</code></pre>

<pre><code>// ES6
const array = [1, 2, 3, 4];
const [first, ,third] = array;
console.log(first, third); // 1 3
</code></pre>

<p>Switch values.</p>

<pre><code>// ES5
var a = 1;
var b = 2;
var tmp = a;
a = b;
b = tmp;
console.log(a, b); // 2 1
</code></pre>

<pre><code>// ES6
let a = 1;
let b = 2;
[a, b] = [b, a];
console.log(a, b); // 2 1
</code></pre>

<p>Return multiple value</p>

<pre><code>// ES5
function margin() {
  var left=1, right=2, top=3, bottom=4;
  return { left: left, right: right, top: top, bottom: bottom };
}
var data = margin();
var left = data.left;
var bottom = data.bottom;
console.log(left, bottom); // 1 4
</code></pre>

<pre><code>// ES6
function margin() {
  const left=1, right=2, top=3, bottom=4;
  return { left, right, top, bottom }; // grammar sugar {left:left} -&gt; {left}
}
const { left, bottom } = margin();
console.log(left, bottom); // 1 4
</code></pre>

<p>Parameter match</p>

<pre><code>// ES5
var user = {firstName: 'Adrian', lastName: 'Mejia'};
function getFullName(user) {
  var firstName = user.firstName;
  var lastName = user.lastName;
  return firstName + ' ' + lastName;
}
console.log(getFullName(user)); // Adrian Mejia
</code></pre>

<pre><code>// ES6
const user = {firstName: 'Adrian', lastName: 'Mejia'};
function getFullName({ firstName, lastName }) {
  return `${firstName} ${lastName}`;
}
console.log(getFullName(user)); // Adrian Mejia
</code></pre>

<p>Deep match</p>

<pre><code>// ES5
function settings() {
  return { display: { color: 'red' }, keyboard: { layout: 'querty'} };
}
var tmp = settings();
var displayColor = tmp.display.color;
var keyboardLayout = tmp.keyboard.layout;
console.log(displayColor, keyboardLayout); // red querty
</code></pre>

<pre><code>// ES6
function settings() {
  return { display: { color: 'red' }, keyboard: { layout: 'querty'} };
}
const { display: { color: displayColor }, keyboard: { layout: keyboardLayout }} = settings();
console.log(displayColor, keyboardLayout); // red querty
</code></pre>

<p>Deconstruction is useful, and helpful in forming a good coding style.
Use array deconstrunction to avoid temporary variables.
Use Object deconstrunction to deal with multiple return values.</p>

<h4 id="class-and-object">Class and Object</h4>

<pre><code>// ES5
var Animal = (function () {
  function MyConstructor(name) {
    this.name = name;
  }
  MyConstructor.prototype.speak = function speak() {
    console.log(this.name + ' makes a noise.');
  };
  return MyConstructor;
})();
var animal = new Animal('animal');
animal.speak(); // animal makes a noise.
</code></pre>

<p>ES6 provides grammar sugar to define a class object.
With <em>class</em>, <em>constructor</em>, you can define speak() instead of constructor.prototype.speak = function().
Use <em>class</em> and avoid deal with <em>prototype</em>. The same functionality, more elegant.</p>

<pre><code>// ES6
class Animal {
  constructor(name) {
    this.name = name;
  }
  speak() {
    console.log(this.name + ' makes a noise.');
  }
}
const animal = new Animal('animal');
animal.speak(); // animal makes a noise.
</code></pre>

<p>Avoid empty constructor. A class has a default constructor itself.</p>

<h4 id="inherit">Inherit</h4>

<p>Inheritance in ES5 is complex.</p>

<pre><code>// ES5
var Lion = (function () {
  function MyConstructor(name){
    Animal.call(this, name);
  }
  // prototypal inheritance
  MyConstructor.prototype = Object.create(Animal.prototype);
  MyConstructor.prototype.constructor = Animal;
  MyConstructor.prototype.speak = function speak() {
    Animal.prototype.speak.call(this);
    console.log(this.name + ' roars ');
  };
  return MyConstructor;
})();
var lion = new Lion('Simba');
lion.speak(); // Simba makes a noise.
// Simba roars.
</code></pre>

<pre><code>// ES6
class Lion extends Animal {
  speak() {
    super.speak();
    console.log(this.name + ' roars ');
  }
}
const lion = new Lion('Simba');
lion.speak(); // Simba makes a noise.
// Simba roars.
</code></pre>

<p>ES6 has <em>extends</em> and <em>super</em>, makes inheritance much clearer.</p>

<h4 id="promise">Promise</h4>

<p><em>promise</em> is used to eliminate the callback hell.</p>

<pre><code>// ES5
function printAfterTimeout(string, timeout, done){
  setTimeout(function(){
    done(string);
  }, timeout);
}
printAfterTimeout('Hello ', 2e3, function(result){
  console.log(result);
  // nested callback
  printAfterTimeout(result + 'Reader', 2e3, function(result){
    console.log(result);
  });
});
</code></pre>

<p>This function exec a callback after done(), twice. More layer of callbacks, it will become a mess.
With <em>promise</em>:</p>

<pre><code>// ES6
function printAfterTimeout(string, timeout){
  return new Promise((resolve, reject) =&gt; {
    setTimeout(function(){
      resolve(string);
    }, timeout);
  });
}
printAfterTimeout('Hello ', 2e3).then((result) =&gt; {
  console.log(result);
  return printAfterTimeout(result + 'Reader', 2e3);
}).then((result) =&gt; {
  console.log(result);
});
</code></pre>

<p>Use <em>promise</em>, another function can be called by <em>then</em> after a function is executed without nesting.</p>

<h4 id="arrow-function">Arrow Function</h4>

<p>In ES5, <em>this</em> point to the environment in which a function is executed, instead of in which it is defined.</p>

<pre><code>// ES5
var _this = this; // need to hold a reference
$('.btn').click(function(event){
  _this.sendData(); // reference outer this
});
$('.input').on('change',function(event){
  this.sendData(); // reference outer this
}.bind(this)); // bind to outer this
</code></pre>

<p>With <code>()=&gt;{}</code>, you don&rsquo;t need to use a temporary variable to hold <em>this</em> or use <em>bind</em>.</p>

<pre><code>// ES6
// this will reference the outer one
$('.btn').click((event) =&gt;  this.sendData());
// implicit returns
const ids = [291, 288, 984];
const messages = ids.map(value =&gt; `ID is ${value}`);
</code></pre>

<h4 id="for-of">for &hellip; of</h4>

<h4 id="default-value-of-function-arguments">default value of function arguments</h4>

<p>Just like in C, Python, and any other languages.</p>

<h4 id="remaining-arguments">&hellip; remaining arguments</h4>

<p>A <em>argumnets</em> like operation.</p>

<pre><code>function printf(format, ...params) {
  console.log('params: ', params);
  console.log('format: ', format);
}
printf('%s %d %.2f', 'adrian', 321, Math.PI);
</code></pre>

<h4 id="open-spread-operator-which-terminology">open/spread operator (??? which terminology)</h4>

<p>In ES5, apply()</p>

<pre><code>Math.max(2,100,1,6,43) // &lt;- 100
Math.max([2,100,1,6,43]) // &lt;- NaN
Math.max.apply(Math, [2,100,1,6,43]) // &lt;- 100
</code></pre>

<p>In ES6, just spread the array.</p>

<pre><code>Math.max(...[2,100,1,6,43]) // 100
</code></pre>

<p>In ES6, concat() arrays.</p>

<pre><code>var array1 = [2,100,1,6,43];
var array2 = ['a', 'b', 'c', 'd'];
var array3 = [false, true, null, undefined];
console.log(array1.concat(array2, array3));
</code></pre>

<p>ES6 spreads nested arrays.</p>

<pre><code>// ES6
const array1 = [2,100,1,6,43];
const array2 = ['a', 'b', 'c', 'd'];
const array3 = [false, true, null, undefined];
console.log([...array1, ...array2, ...array3]);
</code></pre>

<hr />

    
        

<h2 id="note-on-express-basic">Note on Express Basic</h2>

<h3 id="routing">Routing</h3>

<p>A route method is derived from one of the HTTP methods, and is attached to an instance of the express class.</p>

<h4 id="route-methods">Route methods</h4>

<p>Express supports the following routing methods that correspond to HTTP methods:
<code>get, post, put, head, delete, options, trace, copy, lock, mkcol, move, purge, propfind, proppatch, unlock, report, mkactivity, checkout, merge, m-search, notify, subscribe, unsubscribe, patch, search, and connect</code>.</p>

<p>To route methods that translate to invalid JavaScript variable names, use the bracket notation.
<code>app['m-search']('/', function(){})</code></p>

<p>An extra routing method <code>app.all()</code> is used for loading middleware functions at a path for all request methods.</p>

<pre><code>app.get('/', function(req, res) {
})
app.post('/', function(req, res) {
})
app.all('/', function(req, res, next) {
    ;
    next()
})
</code></pre>

<h4 id="route-paths">Route paths</h4>

<p>Route path supports string, string pattern with *? + * ()*, and regular expression.
In string, hyphen and dot are literal characters.</p>

<pre><code>app.get('/ab*c(de)?f', function(req, res) {})
app.get(/.*foo$/, function(req, res) {})
</code></pre>

<p><strong>Route parameters</strong></p>

<p>Express captures named URL segments into <em>req.params</em> object.
&gt; The name of route parameters must be made up of “word characters” ([A-Za-z0-9_]).</p>

<pre><code>Route path: /users/:userId/books/:bookId
Request URL: http://localhost:3000/users/34/books/8989
req.params: { &quot;userId&quot;: &quot;34&quot;, &quot;bookId&quot;: &quot;8989&quot; }

Route path: /flights/:from-:to
Request URL: http://localhost:3000/flights/LAX-SFO
req.params: { &quot;from&quot;: &quot;LAX&quot;, &quot;to&quot;: &quot;SFO&quot; }

Route path: /plantae/:genus.:species
Request URL: http://localhost:3000/plantae/Prunus.persica
req.params: { &quot;genus&quot;: &quot;Prunus&quot;, &quot;species&quot;: &quot;persica&quot; }
</code></pre>

<h4 id="route-handlers">Route handlers</h4>

<p>Route handlers are used to handle a request, and they&rsquo;re chained by <code>next()</code>.
You can use functions, and arrays of functions, and their mix.</p>

<pre><code>var cb0 = function (req, res, next) {
  console.log('CB0')
  next()
}

var cb1 = function (req, res, next) {
  console.log('CB1')
  next()
}

app.get('/example', [cb0, cb1], function (req, res, next) {
  console.log('the response will be sent by the next function ...')
  next()
}, function (req, res) {
  res.send('Hello from D!')
})
</code></pre>

<h4 id="response-methods">Response methods</h4>

<p>A response method sends a response to the client, and terminates the request-response cycle.
If no response method is called, the client request will be left hanging.</p>

<pre><code>- **Method**    **Description**
- res.download()    Prompt a file to be downloaded.
- res.end()         End the response process.
- res.json()        Send a JSON response.
- res.jsonp()       Send a JSON response with JSONP support.
- res.redirect()    Redirect a request.
- res.render()      Render a view template.
- res.send()        Send a response of various types.
- res.sendFile()    Send a file as an octet stream.
- res.sendStatus()  Set the response status code and send its string representation as the response body.
</code></pre>

<h4 id="app-route">app.route()</h4>

<p>It creates a handler-chain for a given route path.</p>

<pre><code>app.route('/book')
  .get(function (req, res) {
    res.send('Get a random book')
  })
  .post(function (req, res) {
    res.send('Add a book')
  })
  .put(function (req, res) {
    res.send('Update the book')
  })
</code></pre>

<h4 id="express-router">express.Router</h4>

<p>Use the express.Router class to create modular, mountable route handlers. A Router instance is a complete middleware and routing system; for this reason, it is often referred to as a “mini-app”.</p>

<p>The following example creates a router as a module, loads a middleware function in it, defines some routes, and mounts the router module on a path in the main app.</p>

<p>Create a router file named birds.js in the app directory, with the following content:</p>

<pre><code>var express = require('express')
var router = express.Router()

// middleware that is specific to this router
router.use(function timeLog (req, res, next) {
  console.log('Time: ', Date.now())
  next()
})
// define the home page route
router.get('/', function (req, res) {
  res.send('Birds home page')
})
// define the about route
router.get('/about', function (req, res) {
  res.send('About birds')
})

module.exports = router
</code></pre>

<p>Then, load the router module in the app:</p>

<pre><code>var birds = require('./birds')

// ...

app.use('/birds', birds)
</code></pre>

<p>The app will now be able to handle requests to /birds and /birds/about, as well as call the timeLog middleware function that is specific to the route.</p>

<hr />

    
        

<h2 id="an-introduction-to-webpack">An Introduction to Webpack</h2>

<p><strong>Webpack</strong> is a bundler for javascript, and related resources.
All resources are treated as modules, and with various <em>loaders</em>,
webpack can handle modules of CommonJs, AMD, ES6, CSS, Image, JSON, Coffeescript, LESS, etc.</p>

<pre><code>// what a webpack config file 'webpack.config.js' looks like
module: {
  loaders: [
    { test: /\.css$/, loader: 'style!css' }, // use ! to chain loaders
    { test: /\.js$/, loader: 'jsx?harmony!babel', exclude: /node_modules/ }
    // loaders can be written like 'jsx-loader' or 'jsx'
    // loaders can take parameters as a querystring
  ]
}
</code></pre>

<p>Entrance and output.</p>

<pre><code>// webpack.config.js
module.exports = {
  entry: './entry.js',
  output: {
    filename: 'bundle.js'
  }
};
</code></pre>

<p>Filename extensions.</p>

<pre><code>// webpack.config.js
module.exports = {
  entry: 'entry.js',
  output: {
    filename: 'bundle.js'
  },
  resolve: {
    extensions: ['', '.js]
    // require('./foo') will search module with filename './foo' and './foo.js'
  }
}
</code></pre>

<h3 id="require-a-module">require a module</h3>

<pre><code>require('foo') // from module directory
require('./bar') // from relative path

define (require, exports.module) -&gt;
  require('foo')
  require('./bar)
</code></pre>

<h4 id="module-shim">module shim</h4>

<p>To require modules from <code>window</code>, you might need <code>expose-loader</code>.
Take jQuery for example</p>

<pre><code>{ test: require.resolve('jquery'), loader: 'expose?jQuery' }
</code></pre>

<h3 id="css-and-image">CSS and Image</h3>

<p>Write loader and require them as normal modules.</p>

<pre><code>// webpack.config.js
module.exports = {
  entry: 'entry.js',
  output: {
    path: './build', // for output processed images and resources
    publicPath: 'http://mycdn.com/', // for generate URLs to resources
    filename: 'bundle.js'
  },
  module: {
    loaders: [
      { test: /\.js$/, loader: 'jsx?harmony!babel', exclude: /node_modules/ }
      { test: /\.css$/, loader: 'style!css },
      { test: /\.less$/, loader: 'style!css!less },
      { test: /\.(png|jpg)$/, loader: 'url?limit=8192' }
      // inline base64 URLs for &lt;=8k images, direct URLs for the rest
    ]
  }
};
</code></pre>

<pre><code>require('./bootstrap.css');
require('./style.less');

let img = document.createElement('img');
img.src = require('./logo.png');
</code></pre>

<h3 id="multi-package-and-shared-package">Multi-package and shared package</h3>

<p>Shared packages are handled by <code>commonsPlugin</code>.</p>

<pre><code>var CommonsChunkPlugin = require(&quot;webpack/lib/optimize/CommonsChunkPlugin&quot;);
module.exports = {
    entry: {
        p1: &quot;./page1&quot;,
        p2: &quot;./page2&quot;,
        p3: &quot;./page3&quot;
    },
    output: {
        filename: &quot;[name].entry.chunk.js&quot;
    },
    plugins: [
        new CommonsChunkPlugin(&quot;commons.chunk.js&quot;)
    ]
}
</code></pre>

<h3 id="separated-css-package-http-webpack-github-io-docs-stylesheets-html-separate-css-bundle"><a href="http://webpack.github.io/docs/stylesheets.html#separate-css-bundle">Separated CSS package</a></h3>

<h3 id="hash-js-files">Hash js files</h3>

<p><em>One hash for the bundle</em>
<code>webpack ./entry output.[hash].bundle.js</code></p>

<pre><code>{
    output: {
        path: path.join(__dirname, &quot;assets&quot;, &quot;[hash]&quot;),
        publicPath: &quot;assets/[hash]/&quot;,
        filename: &quot;output.[hash].bundle.js&quot;,
        chunkFilename: &quot;[id].[hash].bundle.js&quot;
    }
}
</code></pre>

<p><em>One hash per chunk</em> <code>--output-chunk-file [chunkhash].js</code></p>

<pre><code>output: { chunkFilename: &quot;[chunkhash].bundle.js&quot; }
</code></pre>

<p><em>Get filenames from stats</em></p>

<pre><code>plugins: [
  function() {
    this.plugin(&quot;done&quot;, function(stats) {
      require(&quot;fs&quot;).writeFileSync(
        path.join(__dirname, &quot;..&quot;, &quot;stats.json&quot;),
        JSON.stringify(stats.toJson()));
    });
  }
]
</code></pre>

<h3 id="options-for-product">Options for Product</h3>

<p>You can specify a different config file for product-level bundling.
<code>webpack --config webpack.min.js</code></p>

<p>Compress the code. Loaders are switched into minimizing mode.
<a href="http://webpack.github.io/docs/list-of-plugins.html#uglifyjsplugin">Uglify</a></p>

<pre><code>plugins: [
   new webpack.optimize.MinChunkSizePlugin(minSize)
]
</code></pre>

<pre><code>new webpack.optimize.UglifyJsPlugin([options])
// e.g.
new webpack.optimize.UglifyJsPlugin({
    compress: {
        warnings: false
    }
})
</code></pre>

<p>You can/should use normal npm React package instead of the precompiled library.
Webpack can compress it to smaller size than react.min.js.</p>

<pre><code>new webpack.DefinePlugin({
  &quot;process.env&quot;: {
    NODE_ENV: JSON.stringify(&quot;production&quot;)
  }
})
</code></pre>

<h4 id="hot-replace">Hot Replace</h4>

<p>Include <code>webpack/hot/dev-server</code> in your project code, edit config file.</p>

<pre><code>  entry: {
    main: ['webpack/hot/dev-server', './entry],
  },
</code></pre>

<p>Then start the server, and visit it at [<a href="http://localhost:8080/webpack-dev-server/">http://localhost:8080/webpack-dev-server/</a>].</p>

<pre><code>webpack-dev-server --hot --quiet
</code></pre>

<p>And there is a <a href="http://gaearon.github.io/react-hot-loader/getstarted/"><strong>react-hot-loader</strong></a>.</p>

<pre><code>entry: [
  'webpack-dev-server/client?http://0.0.0.0:8080', // WebpackDevServer host and port
  'webpack/hot/only-dev-server',
  './scripts/index' // Your appʼs entry point
]
</code></pre>

<p>As for <code>only-dev-server</code>, the issue is replied <a href="https://github.com/gaearon/react-hot-loader/issues/73#issuecomment-73679446">here</a>.</p>

<h3 id="miscellaneous">Miscellaneous</h3>

<p>When webpack reports an error, but you cannot find out what&rsquo;s wrong, try this.</p>

<pre><code>webpack --display-error-details
</code></pre>

<hr />

<p>[Webpack list of loaders] <a href="http://webpack.github.io/docs/list-of-loaders.html">http://webpack.github.io/docs/list-of-loaders.html</a>
<a href="https://github.com/webpack/docs/wiki/optimization#multi-page-app">optimization</a>
[long term caching]<a href="http://webpack.github.io/docs/long-term-caching.html">http://webpack.github.io/docs/long-term-caching.html</a></p>

    
        

<h2 id="another-webpack-note">Another Webpack Note</h2>

<p><code>
其实Webpack的入门指导文章非常多，配置方式也各有各样，这里我推荐题叶大神的入门级指南–Webpack 入门指迷，如果不知道Webpack是什么或者不是很清楚各项配置含义的开发者，可以看此文章扫扫盲。毕竟我这篇文章并不是特别基础。
</code></p>

<h3 id="1-base-js">1. base.js</h3>

<p>var path = require(&lsquo;path&rsquo;)
var baseConfig = {
    resolve: {
        extensions: [&ldquo;, &lsquo;.js&rsquo;],
        fallback: [path.join(<strong>dirname, &lsquo;../node_modules&rsquo;)],
        alias: {
            &lsquo;src&rsquo;: path.resolve(</strong>dirname, &lsquo;../src&rsquo;),
            &lsquo;assets&rsquo;: path.resolve(<strong>dirname, &lsquo;../src/assets&rsquo;),
            &lsquo;components&rsquo;: path.resolve(</strong>dirname, &lsquo;../src/components&rsquo;)
        }
    },
    module: {
        loaders: [{
            test: /.js$/,
            loader: &lsquo;babel&rsquo;,
            exclude: /node_modules/
        }, {
            test: /.(png|jpe?g|gif|svg|woff2?|eot|ttf|otf)(\?.*)?$/,
            loader: &lsquo;url?limit=8192&amp;context=client&amp;name=[path][name].[hash:7].[ext]&rsquo;
        },
        {
            test: /.css$/,
            loader: &lsquo;style!css!autoprefixer&rsquo;,
        },
        {
            test: /.scss$/,
            loader: &lsquo;style!css!autoprefixer!sass&rsquo;
        }]
    }
};</p>

<p>module.exports = baseConfig;</p>

<p>`
解读下这个基本配置：</p>

<p>1、resolve 解析模块依赖的时候，受影响的配置项。</p>

<p>extensions 决定了哪些文件后缀在引用的时候可以省略点，Webpack帮助你补全名称。
fallback 当webpack在 root（默认当前文件夹，配置时要绝对路径） 和 modulesDirectories（默认当前文件夹，相对路径）配置下面找不到相关modules，去哪个文件夹下找modules
alias 这个大家应该比较熟悉，requirejs之类的都有，就是别名，帮助你快速指向文件路径，少写不少代码，而且不用关心层级关系，需要注意的是：在scss之类的css预编译中引用要加上~，以便于让loader识别是别名引用路径。</p>

<p>2、module 解析不同文件使用哪些loader，这个比较简单，很多文章都有，就不多说了，注意的是，这里的scss可以换成你自己的预编译器，例如：sass、less、stylus等，或者直接用postcss都行，当然还可以用一种通用方法，后面补上。
`</p>

<h3 id="2-开发环境配置-config">2. 开发环境配置 config</h3>

<p>var webpack = require(&lsquo;webpack&rsquo;);
var path = require(&lsquo;path&rsquo;)
var merge = require(&lsquo;webpack-merge&rsquo;)
var baseConfig = require(&lsquo;./webpack.base&rsquo;)
var getEntries = require(&lsquo;./getEntries&rsquo;)</p>

<p>var hotMiddlewareScript = &lsquo;webpack-hot-middleware/client?reload=true&rsquo;;</p>

<p>var assetsInsert = require(&lsquo;./assetsInsert&rsquo;)</p>

<p>module.exports = merge(baseConfig, {
  entry: getEntries(hotMiddlewareScript),
  devtool: &lsquo;#eval-source-map&rsquo;,
  output: {
    filename: &lsquo;./[name].[hash].js&rsquo;,
    path: path.resolve(&lsquo;./dist&rsquo;),
    publicPath:&lsquo;./dist&rsquo;
  },
  plugins: [
    new webpack.DefinePlugin({
      &lsquo;process.env&rsquo;: {
        NODE_ENV: &lsquo;&ldquo;development&rdquo;&rsquo;
      }
    }),
    new webpack.optimize.OccurenceOrderPlugin(),
    new webpack.HotModuleReplacementPlugin(),
    new webpack.NoErrorsPlugin(),
    new assetsInsert()
  ]
})</p>

<p>`
说说这个配置中的一些难点：</p>

<p>1、getEntries 是用来配置入口文件，一般很多人是自己手写，或者SPA页面，只有一个入口， 很容易就写出来，但是公司中，很多情况，是需要多入口，也就是多路由的Url，这个时候入口的配置就比较麻烦，我这里是放单独一个文件里面配置，我们公司是靠规定来执行，也就是一个文件夹所有的main.js都认为是入口文件，其他都忽略。
`</p>

<p>function getEntry(hotMiddlewareScript) {
    var pattern = paths.dev.js + &lsquo;project/**/main.js&rsquo;;
    var array = glob.sync(pattern);
    var newObj = {};</p>

<pre><code>array.map(function(el){
    var reg = new RegExp('project/(.*)/main.js','g');
    reg.test(el);
    if (hotMiddlewareScript) {
        newObj[RegExp.$1] = [el, hotMiddlewareScript];
    } else {
        newObj[RegExp.$1] = el;
    }
});
return newObj;
</code></pre>

<p>}</p>

<p><code>
2、assetsInsert 是用来做模板替换的，一个小插件把template里面的值替换成打包后的css或者js。
</code></p>

<h3 id="3-打包环境配置-production">3. 打包环境配置 production</h3>

<p>var webpack = require(&lsquo;webpack&rsquo;);
var path = require(&lsquo;path&rsquo;)
var merge = require(&lsquo;webpack-merge&rsquo;)
var baseConfig = require(&lsquo;./webpack.base&rsquo;)
var getEntries = require(&lsquo;./getEntries&rsquo;)
var ExtractTextPlugin = require(&lsquo;extract-text-webpack-plugin&rsquo;);
var assetsInsert = require(&lsquo;./assetsInsert&rsquo;)</p>

<p>var productionConf = merge(baseConfig, {
    entry: getEntries(),
    output: {
        filename: &lsquo;./[name].[hash].js&rsquo;,
        path: path.resolve(&lsquo;./public/dist&rsquo;),
        publicPath: &lsquo;./&rsquo;
    },
    plugins: [
        new webpack.DefinePlugin({
            &lsquo;process.env&rsquo;: {
                NODE_ENV: &lsquo;&ldquo;production&rdquo;&rsquo;
            }
        }),
        new ExtractTextPlugin(&lsquo;./[name].[hash].css&rsquo;, {
            allChunks: true
        }),
        new webpack.optimize.UglifyJsPlugin({
            compress: {
                warnings: false
            }
        }),
        new webpack.optimize.OccurenceOrderPlugin(),
        new assetsInsert()
    ]
})</p>

<p>productionConf.module.loaders = [
             {
                test: /.js$/,
                loader: &lsquo;babel&rsquo;,
                exclude: /node_modules/
            }, {
                test: /.(png|jpe?g|gif|svg|woff2?|eot|ttf|otf)(\?.*)?$/,
                loader: &lsquo;url?limit=8192&amp;context=client&amp;name=[path][name].[hash:7].[ext]&rsquo;
            },
            {
                test: /.css$/,
                loader: ExtractTextPlugin.extract(&lsquo;style&rsquo;, &lsquo;css&rsquo;),
            },
            {
                test: /.scss$/,
                loader: ExtractTextPlugin.extract(&lsquo;style&rsquo;, &lsquo;css!sass&rsquo;)
            }]</p>

<p>module.exports = productionConf</p>

<p>`
基本跟开发的差不多，差别在于：</p>

<p>1、使用ExtractTextPlugin 来打包css，所以要干掉原来base的loaders，重新写了一个，在最下面。</p>

<p>2、UglifyJsPlugin 给js压缩代码。其他没有什么好解释的了，一样的。
`</p>

<h3 id="4-构建命令">4. 构建命令</h3>

<p>require(&lsquo;shelljs/global&rsquo;)
env.NODE_ENV = &lsquo;production&rsquo;
var ora = require(&lsquo;ora&rsquo;)
var webpack = require(&lsquo;webpack&rsquo;)
var webpackConfig = require(&lsquo;./webpack.production.config&rsquo;)</p>

<p>var spinner = ora(&lsquo;building for production&hellip;&rsquo;)
spinner.start()</p>

<p>var staticPath = __dirname + &lsquo;/../public/dist/&rsquo;
rm(&lsquo;-rf&rsquo;, staticPath)
mkdir(&lsquo;-p&rsquo;, staticPath)</p>

<p>webpack(webpackConfig, function (err, stats) {
  spinner.stop()
  if (err) throw err
  process.stdout.write(stats.toString({
    colors: true,
    modules: false,
    children: false,
    chunks: false,
    chunkModules: false
  }) + &lsquo;\n&rsquo;)
})</p>

<p>`
写一个build.js，然后在package.json里面添加 script 参数</p>

<p>&ldquo;build&rdquo;: &ldquo;node build.js&rdquo;//这里记得写自己build.js路径
`</p>

<h3 id="5-甜点-马卡龙-有点腻">5. 甜点（马卡龙） 有点腻</h3>

<p><code>
上面的配置是可以更改的，例如你在loaders 里面加上
</code>
{
  test: /.vue$/,
  loader: &lsquo;vue&rsquo;
}
`
就可以变成支持.vue文件的vuejs打包构建，同理，修改下支持jsx，和添加一些reactjs的module，就可以用来跑Reactjs的东西。</p>

<p>还有可以随意更改Css预编译器的类型，用你自己喜欢就行，或者跟我们前面提到的方法，把所有类型都配置上，
`
var path = require(&lsquo;path&rsquo;)
var config = require(&lsquo;../config&rsquo;)
var ExtractTextPlugin = require(&lsquo;extract-text-webpack-plugin&rsquo;)</p>

<p>exports.assetsPath = function (_path) {
  return path.posix.join(config.build.assetsSubDirectory, _path)
}</p>

<p>exports.cssLoaders = function (options) {
  options = options || {}
  // generate loader string to be used with extract text plugin
  function generateLoaders (loaders) {
    var sourceLoader = loaders.map(function (loader) {
      var extraParamChar
      if (/\?/.test(loader)) {
        loader = loader.replace(/\?/, &lsquo;-loader?&rsquo;)
        extraParamChar = &lsquo;&amp;&rsquo;
      } else {
        loader = loader + &lsquo;-loader&rsquo;
        extraParamChar = &lsquo;?&rsquo;
      }
      return loader + (options.sourceMap ? extraParamChar + &lsquo;sourceMap&rsquo; : &ldquo;)
    }).join(&lsquo;!&rsquo;)</p>

<pre><code>if (options.extract) {
  return ExtractTextPlugin.extract('vue-style-loader', sourceLoader)
} else {
  return ['vue-style-loader', sourceLoader].join('!')
}
</code></pre>

<p>}</p>

<p>// <a href="http://vuejs.github.io/vue-loader/configurations/extract-css.html">http://vuejs.github.io/vue-loader/configurations/extract-css.html</a>
  return {
    css: generateLoaders([&lsquo;css&rsquo;]),
    postcss: generateLoaders([&lsquo;css&rsquo;]),
    less: generateLoaders([&lsquo;css&rsquo;, &lsquo;less&rsquo;]),
    sass: generateLoaders([&lsquo;css&rsquo;, &lsquo;sass?indentedSyntax&rsquo;]),
    scss: generateLoaders([&lsquo;css&rsquo;, &lsquo;sass&rsquo;]),
    stylus: generateLoaders([&lsquo;css&rsquo;, &lsquo;stylus&rsquo;]),
    styl: generateLoaders([&lsquo;css&rsquo;, &lsquo;stylus&rsquo;])
  }
}</p>

<p>// Generate loaders for standalone style files (outside of .vue)
exports.styleLoaders = function (options) {
  var output = []
  var loaders = exports.cssLoaders(options)
  for (var extension in loaders) {
    var loader = loaders[extension]
    output.push({
      test: new RegExp(&rsquo;\.&rsquo; + extension + &lsquo;$&rsquo;),
      loader: loader
    })
  }
  return output
}</p>

<p><code>
这就是把所有的css预编译的都加到配置里面了。
</code></p>

    
        

<h1 id="tools">Tools</h1>

    
        

<h2 id="makefile">Makefile</h2>

<h3 id="make-basic">Make Basic</h3>

<p><em>make</em> is designed to manage the compiling process based on dependencies. The other functions of make is designed to make it easier to write Makefile.</p>

<hr />

<p>When we deal with a complex project, there might be lots of source files, header files, lib files, target files.
The files have a certain dependency relationship.</p>

<pre><code>$ gcc -c -o test.o test.c
$ gcc -o helloworld test.o
</code></pre>

<p>The dependency line is: <code>test.c</code> -&gt; <code>test.o</code> -&gt; <code>helloworld</code>.</p>

<p>When dealing with many files, the compiler is called many times. We build the files on which is depended, then build target files on top of that.</p>

<p>And <em>make</em> is a tool to automatically record and process the dependency.
The dependency relationship is written in the Makefile file, and <em>make</em> will compile the files w.r.t. the dependency described in Makefile.</p>

<h4 id="dependency">Dependency</h4>

<p>Here is a basic Makeifle</p>

<pre><code># target binary file: helloworld
helloworld: test.o
	echo &quot;good&quot;
	gcc -o helloworld test.o

test.o: test.c
	gcc -c -o test.o test.c
</code></pre>

<ul>
<li># starts a comment line</li>
<li>a target depends on its prerequisite. Multiple files are separated by spaces.</li>
<li>The lines indented by Tab are operations to implement a dependency relationship. These operations are normal Shell commands.</li>
</ul>

<p><em>make</em> is a recursive process.</p>

<blockquote>
<ul>
<li>If the current dependency has not prerequisite, then execute operations directly.</li>
<li>If the current dependency has prerequisite, and the required files exist and have not been changed since the last make (judged by write-timestamp), then execute operations directly.</li>
<li>If the required files of the current dependency do not exist, or have been changed, then use the required files as target files, and search their dependency, create target files.</li>
</ul>
</blockquote>

<h4 id="macro">Macro</h4>

<p>Macro in <em>make</em> is text-type variable.</p>

<pre><code>CC = gcc
helloworld: test.o
　　echo &quot;good&quot;
　　$(CC) -o helloworld test.o

test.o: test.c
　　$(CC) -c -o test.o test.c
</code></pre>

<h4 id="inner-macro">Inner Macro</h4>

<ul>
<li><code>$@</code> is target filename of the current dependency.</li>
<li><code>$^</code> is required filenames of the current dependency.</li>
<li><code>$*</code> target filename without suffix of the current dependency</li>
<li><code>$*</code> the changed files in the current dependency</li>
<li><code>$$</code> character $</li>
<li><code>$(@D)</code> directory of file path</li>
<li><code>$(@F)</code> filename of file path</li>
</ul>

<pre><code>CC = gcc
helloworld: test.o
　　echo $@
　　$(CC) -o $@ $^

test.o: test.c
　　$(CC) -c -o $@ $^
</code></pre>

<h4 id="suffix-dependency">Suffix Dependency</h4>

<pre><code>CC = gcc

.SUFFIXES: .c .o

.c.o:
	$(CC) -c -o $@ $^

#--------------------------
helloworld: test.o
	echo $@
	$(CC) -o $@ $^

test.o: test.c
</code></pre>

<p><code>.c.o</code> means <code>.c</code> is prerequisite, and <code>.o</code> is target.
<em>make</em> will find test.o and test.c has dependency, and will execute operation for this dependency.</p>

<p>Suffix dependency is very handy is big projects.</p>

<h4 id="misc">Misc</h4>

<p>Special dependency in makefile.</p>

<p>all: if <em>make</em> was followed by no filename, &ldquo;all&rdquo; will be chosen.</p>

<p>clean: it is used to clean legacy files.</p>

<pre><code>CC = gcc

.SUFFIXES: .c .o

.c.o:
        $(CC) -c -o $@ $^

#--------------------------

all: helloworld
        @echo &quot;ALL&quot;

helloworld: test.o
        @echo $@
        $(CC) -o $@ $^

test.o: test.c

clean:
        -rm helloworld *.o
</code></pre>

<p>&rsquo;@&rsquo; will hide the following command itself.
&lsquo;-&rsquo; will ignore the stderr of the following command.</p>

    
        

<h1 id="python">Python</h1>

<h2 id="class-自带函数">Class 自带函数</h2>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">class</span> <span class="nc">Foor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Bar</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Bar</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;call&#39;</span><span class="p">)</span>
        
<span class="n">foo</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>
<span class="n">foo</span><span class="p">()</span>

<span class="c1"># Result:</span>
<span class="n">new</span>
<span class="n">init</span>
<span class="n">call</span>
</code></pre></div>

<ul>
<li><p><code>__init__(self, *args, **kwargs)</code><br />
在对象创建完成后调用，对当前对象实例进行初始化，无返回值。</p></li>

<li><p><code>__new__(cls, *args, **kwargs)</code><br />
创建对象时调用，返回当前对象的一个实例。</p></li>

<li><p><code>__call__(self, *args, **kwargs)</code><br />
重载括号运算符。类实现了call方法，则其对象可当作函数使用。</p></li>
</ul>

<h2 id="用自带函数实现单例">用自带函数实现单例</h2>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">class</span> <span class="nc">MySingleton</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;_instance&#39;</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MySingleton</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>
</code></pre></div>

    
        

<h1 id="network">Network</h1>

<h2 id="header-2">header 2</h2>

<p><strong>inline code</strong></p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span><span class="k">return</span> <span class="mi">0</span><span class="p">;}</span>
</code></pre></div>

<p><em>some code in python</em></p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">pass</span>
    
</code></pre></div>

    
        
    
        
    
        

<h2 id="practice-of-javascript-performance">Practice of JavaScript Performance</h2>

<p>Since JavaScript becomes a fullstack programming language, in certain cases the performance of JS is critical. Here are some practice of JS, with some understanding of JS implementation.</p>

<h3 id="data-store">Data Store</h3>

<p>How a variable is create will effect its performance.
- Use <em>{}</em> instead of <em>new Object</em>, use <em>[]</em> instead of new Array, use plain string instead of an object.
- Use local temporary variable to store variable deep upon the data-chain, and values require many calculation.
- dot-present has a similar performance as member operator, and it&rsquo;s faster in Safari. object.name vs object[name], object.name is always faster.</p>

<h3 id="loop">Loop</h3>

<p>In Chromium v54, <code>for-in</code> is slower, and <code>for (var i = 0; i &lt; length; ++i)</code>, <code>[].forEach(()=&gt;{})</code> have similar performance. forEach is much faster than it was in earlier browser.</p>

<h3 id="event-delegate">Event Delegate</h3>

<p>It will cause too much loads and occupy too many memory binding the same event to massive elements in the page.
It better to bind event to the outer layer, and deal with all events of its child elements.</p>

<pre><code>document.getElementById('content').addEventListener('click', function(evt) {
    evt = evt || window.event;
    let target = evt.target || evt.srcElement;
    if (target.nodeName.toLowerCase() !== 'a')
        return;
    console.log(target.href);
});
</code></pre>

<h3 id="re-render">Re-Render</h3>

<p>The source files create 2 trees in browser: DOM tree and Render tree.
Render tree deal with DOM geometry attributions. When the style of DOM changes, browser re-render the DOM.</p>

<pre><code>bodystyle = document.body.style; 
bodystyle.color = red; 
bodystyle.height = 1000px; 
bodystyke.width = 100%;
</code></pre>

<p>Three times of modification will cause 3 re-renders. Under certain circumstances, reduce the times of modification will improve rendering performance.</p>

<pre><code>bodystyle = document.body.style; 
bodystyle.cssText 'color:red;height:1000px;width:100%';
</code></pre>

<h3 id="javascript-load">JavaScript Load</h3>

<p>&lt;script&gt; tag might block something from downloading, so it&rsquo;s a good practice to put more script tag at the bottom of DOM, to avoid the time of empty page displayed to users.</p>

<h3 id="javascript-deployment">JavaScript Deployment</h3>

<p>Reduce the number of requirements and the file sizes will accelerate the page loading speed.
For example, use <em>webpack</em> and <em>uglify</em>.</p>

<h3 id="cache-js-files">Cache JS Files</h3>

<p>Cached files will improve the speed of page loading. Web servers use &ldquo;Expires HTTP Resonse Header&rdquo; to tell browser how long a resource should be cached. To avoid the problem of using old version of file, you can change the filename of static resource, like bundle-201612242359.js, using a timestamp to force browser to load the new js file.</p>

    

        </div>
        <div class="dark-box">
            
            <div class="lang-selector">
                
                <a href="#" data-language-name="go">Go</a>
                
                <a href="#" data-language-name="c&#43;&#43;">C&#43;&#43;</a>
                
                <a href="#" data-language-name="shell">Shell</a>
                
                <a href="#" data-language-name="python">Python</a>
                
                <a href="#" data-language-name="javascript">Javascript</a>
                
            </div>
            
        </div>
    </div>
    
</body>
</html>
